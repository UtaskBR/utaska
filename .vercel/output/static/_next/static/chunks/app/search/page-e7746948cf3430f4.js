(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[797],{6708:function(e,t,s){Promise.resolve().then(s.bind(s,4073))},4073:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return h}});var r=s(7437),a=s(2265),n=s(4033),c=s(8980);function o(e){let{id:t,label:s,type:n="text",placeholder:o,value:l,onChange:i,onBlur:d,error:u,required:m=!1,disabled:x=!1,className:h="",icon:g,maxLength:p,min:b,max:f,step:j,rows:v=3}=e,[y,N]=(0,a.useState)(!1),w=u?"border-red-500 focus:ring-red-500 pr-10":"border-utask-gray focus:ring-utask-blue",k=x?"bg-gray-100 cursor-not-allowed":"",C=g?"pl-10":"",S="\n    ".concat("w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 transition-all duration-200","\n    ").concat(w,"\n    ").concat(k,"\n    ").concat(C,"\n    ").concat(h,"\n  ");return"textarea"===n?(0,r.jsxs)("div",{className:"mb-4",children:[s&&(0,r.jsxs)("label",{htmlFor:t,className:"block text-sm font-medium text-gray-700 mb-1",children:[s,m&&(0,r.jsx)("span",{className:"text-red-500 ml-1",children:"*"})]}),(0,r.jsxs)("div",{className:"relative",children:[g&&(0,r.jsx)("div",{className:"absolute left-3 top-3 text-gray-400",children:g}),(0,r.jsx)("textarea",{id:t,value:l,onChange:i,onBlur:d,placeholder:o,disabled:x,required:m,maxLength:p,rows:v,className:S}),u&&(0,r.jsx)("div",{className:"absolute right-3 top-3 text-red-500",children:(0,r.jsx)(c.bcx,{size:18})})]}),u&&(0,r.jsx)("p",{className:"mt-1 text-sm text-red-500",children:u})]}):(0,r.jsxs)("div",{className:"mb-4",children:[s&&(0,r.jsxs)("label",{htmlFor:t,className:"block text-sm font-medium text-gray-700 mb-1",children:[s,m&&(0,r.jsx)("span",{className:"text-red-500 ml-1",children:"*"})]}),(0,r.jsxs)("div",{className:"relative",children:[g&&(0,r.jsx)("div",{className:"absolute left-3 top-2.5 text-gray-400",children:g}),(0,r.jsx)("input",{id:t,type:"password"===n&&y?"text":n,value:l,onChange:i,onBlur:d,placeholder:o,disabled:x,required:m,maxLength:p,min:b,max:f,step:j,className:S}),"password"===n&&(0,r.jsx)("button",{type:"button",onClick:()=>{N(!y)},className:"absolute right-3 top-2.5 text-gray-400 hover:text-gray-600",children:y?(0,r.jsx)(c.rzC,{size:18}):(0,r.jsx)(c.rDJ,{size:18})}),u&&"password"!==n&&(0,r.jsx)("div",{className:"absolute right-3 top-2.5 text-red-500",children:(0,r.jsx)(c.bcx,{size:18})})]}),u&&(0,r.jsx)("p",{className:"mt-1 text-sm text-red-500",children:u})]})}function l(e){let{children:t,variant:s="primary",size:a="md",fullWidth:n=!1,disabled:c=!1,onClick:o,type:l="button",className:i="",icon:d,loading:u=!1}=e,m="\n    ".concat("rounded-lg font-medium transition-all duration-200 flex items-center justify-center","\n    ").concat({primary:"bg-utask-blue text-white hover:bg-utask-blue-dark shadow-button",secondary:"bg-white text-utask-blue border border-utask-blue hover:bg-utask-gray-light",danger:"bg-red-500 text-white hover:bg-red-600",outline:"bg-transparent text-gray-700 border border-gray-300 hover:bg-gray-100",text:"bg-transparent text-utask-blue hover:text-utask-blue-dark hover:underline"}[s],"\n    ").concat({sm:"px-3 py-1.5 text-sm",md:"px-4 py-2",lg:"px-6 py-3 text-lg"}[a],"\n    ").concat(c||u?"opacity-50 cursor-not-allowed":"cursor-pointer","\n    ").concat(n?"w-full":"","\n    ").concat(i,"\n  ");return(0,r.jsx)("button",{type:l,className:m,onClick:o,disabled:c||u,children:u?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("svg",{className:"w-5 h-5 mr-2 text-white animate-spin",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,r.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,r.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Carregando..."]}):(0,r.jsxs)(r.Fragment,{children:[d&&(0,r.jsx)("span",{className:"mr-2",children:d}),t]})})}function i(e){let{children:t,title:s,subtitle:a,footer:n,className:c="",onClick:o,hoverable:l=!1,bordered:i=!0,elevated:d=!0}=e,u="\n    ".concat("bg-white rounded-xl overflow-hidden","\n    ").concat(i?"border border-utask-gray":"","\n    ").concat(d?"shadow-card":"","\n    ").concat(l?"transition-transform duration-200 hover:scale-[1.02] cursor-pointer":"","\n    ").concat(c,"\n  ");return(0,r.jsxs)("div",{className:u,onClick:o,children:[(s||a)&&(0,r.jsxs)("div",{className:"px-4 py-3 border-b border-utask-gray",children:[s&&(0,r.jsx)("h3",{className:"text-lg font-semibold",children:s}),a&&(0,r.jsx)("p",{className:"text-sm text-gray-500",children:a})]}),(0,r.jsx)("div",{className:"p-4",children:t}),n&&(0,r.jsx)("div",{className:"px-4 py-3 border-t border-utask-gray bg-utask-gray-light",children:n})]})}function d(e){var t,s;let{service:a,showActions:n=!0,onViewDetails:o,onMakeProposal:d}=e;return(0,r.jsxs)(i,{className:"relative h-full flex flex-col",hoverable:!0,children:[(0,r.jsx)("div",{className:"absolute top-2 right-2",children:(0,r.jsx)("span",{className:"px-2 py-1 text-xs font-medium rounded-full ".concat((e=>{switch(e){case"pending":return"bg-yellow-100 text-yellow-800";case"in_progress":return"bg-blue-100 text-blue-800";case"completed":return"bg-green-100 text-green-800";case"cancelled":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}})(a.status)),children:(e=>{switch(e){case"pending":return"Pendente";case"in_progress":return"Em andamento";case"completed":return"Conclu\xeddo";case"cancelled":return"Cancelado";default:return e}})(a.status)})}),(0,r.jsxs)("div",{className:"mb-3",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold",children:a.title}),a.category&&(0,r.jsx)("span",{className:"text-sm text-gray-500",children:a.category.name})]}),(0,r.jsx)("p",{className:"text-sm text-gray-600 mb-4 line-clamp-2",children:a.description}),(0,r.jsxs)("div",{className:"space-y-2 text-sm text-gray-600 mb-4 flex-grow",children:[(0,r.jsxs)("div",{className:"flex items-start",children:[(0,r.jsx)(c.TCC,{className:"mt-1 mr-2 shrink-0"}),(0,r.jsx)("span",{children:function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e)return"";let s="string"==typeof e?new Date(e):e,r={day:"2-digit",month:"2-digit",year:"numeric"};return t&&(r.hour="2-digit",r.minute="2-digit"),new Intl.DateTimeFormat("pt-BR",r).format(s)}(a.date,!0)})]}),a.location&&(0,r.jsxs)("div",{className:"flex items-start",children:[(0,r.jsx)(c.i63,{className:"mt-1 mr-2 shrink-0"}),(0,r.jsx)("span",{children:a.location})]}),void 0!==a.distance&&(0,r.jsxs)("div",{className:"flex items-start",children:[(0,r.jsx)("span",{className:"mr-2",children:"\uD83D\uDCCD"}),(0,r.jsx)("span",{children:(t=a.distance)>=1e3?"".concat((t/1e3).toLocaleString("pt-BR",{maximumFractionDigits:1})," km"):"".concat(Math.round(t).toLocaleString("pt-BR")," m")})]}),a.user&&(0,r.jsxs)("div",{className:"flex items-start",children:[(0,r.jsx)(c.fzv,{className:"mt-1 mr-2 shrink-0"}),(0,r.jsx)("span",{children:a.user.name})]}),(0,r.jsxs)("div",{className:"flex items-start",children:[(0,r.jsx)(c.oQC,{className:"mt-1 mr-2 shrink-0"}),(0,r.jsx)("span",{children:(s=a.price,new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(s))})]})]}),n&&(0,r.jsxs)("div",{className:"mt-auto pt-2 flex flex-col space-y-2",children:[(0,r.jsx)(l,{variant:"primary",fullWidth:!0,onClick:()=>{o&&o(a.id)},children:"Ver Detalhes"}),"pending"===a.status&&d&&(0,r.jsx)(l,{variant:"outline",fullWidth:!0,onClick:()=>{d&&d(a.id)},children:"Fazer Proposta"})]})]})}var u=s(8222);function m(){return(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center py-12",children:[(0,r.jsx)("div",{className:"w-12 h-12 border-4 border-t-4 border-gray-200 rounded-full border-t-utask-blue animate-spin mb-4"}),(0,r.jsx)("p",{className:"text-gray-500",children:"Carregando resultados..."})]})}function x(){let e=(0,n.useSearchParams)(),t=(0,n.useRouter)(),[s,x]=(0,a.useState)(e.get("q")||""),[h,g]=(0,a.useState)(e.get("category")||""),[p,b]=(0,a.useState)(e.get("location")||""),[f,j]=(0,a.useState)([]),[v,y]=(0,a.useState)([]),[N,w]=(0,a.useState)(!0),[k,C]=(0,a.useState)(""),[S,E]=(0,a.useState)(!1);(0,a.useEffect)(()=>{(async()=>{try{let e=await (0,u.U2)("/api/categories");if(e.error)throw Error(e.error);y(e.data.categories||[])}catch(e){console.error("Erro ao buscar categorias:",e)}})()},[]),(0,a.useEffect)(()=>{let t=async()=>{try{w(!0),C("");let e="/api/services?",t=new URLSearchParams;s&&t.append("q",s),h&&t.append("category",h),p&&t.append("location",p),e+=t.toString();let r=await (0,u.U2)(e);if(r.error)throw Error(r.error);j(r.data.services||[])}catch(e){console.error("Erro ao buscar servi\xe7os:",e),C("N\xe3o foi poss\xedvel carregar os servi\xe7os. Por favor, tente novamente.")}finally{w(!1)}};e.get("q")||e.get("category")||e.get("location")?t():w(!1)},[e]);let z=e=>{t.push("/services/".concat(e))},B=e=>{t.push("/services/".concat(e,"/propose"))};return(0,r.jsxs)("div",{className:"container p-4 mx-auto",children:[(0,r.jsx)("h1",{className:"mb-6 text-2xl font-bold",children:"Buscar Servi\xe7os"}),(0,r.jsx)(i,{className:"mb-6",children:(0,r.jsxs)("form",{onSubmit:e=>{e.preventDefault();let r=new URLSearchParams;s&&r.append("q",s),h&&r.append("category",h),p&&r.append("location",p),t.push("/search?".concat(r.toString()))},children:[(0,r.jsx)("div",{className:"mb-4",children:(0,r.jsx)(o,{id:"search-query",label:"O que voc\xea est\xe1 procurando?",placeholder:"Ex: Encanador, Eletricista, Design de Logo...",value:s,onChange:e=>x(e.target.value),icon:(0,r.jsx)(c.jRj,{})})}),(0,r.jsx)("div",{className:"mb-4",children:(0,r.jsxs)("button",{type:"button",className:"flex items-center text-utask-blue",onClick:()=>E(!S),children:[(0,r.jsx)(c.Ihx,{className:"mr-2"}),S?"Esconder filtros":"Mostrar filtros"]})}),S&&(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"category",className:"block text-sm font-medium text-gray-700 mb-1",children:"Categoria"}),(0,r.jsxs)("select",{id:"category",value:h,onChange:e=>g(e.target.value),className:"w-full px-3 py-2 border border-utask-gray rounded-lg focus:outline-none focus:ring-2 focus:ring-utask-blue",children:[(0,r.jsx)("option",{value:"",children:"Todas as categorias"}),v.map(e=>(0,r.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,r.jsx)("div",{children:(0,r.jsx)(o,{id:"location",label:"Localiza\xe7\xe3o",placeholder:"Cidade, Estado ou CEP",value:p,onChange:e=>b(e.target.value),icon:(0,r.jsx)(c.i63,{})})})]}),(0,r.jsx)("div",{className:"mt-4",children:(0,r.jsx)(l,{type:"submit",fullWidth:!0,children:"Buscar"})})]})}),N?(0,r.jsx)(m,{}):k?(0,r.jsx)("div",{className:"p-4 mb-4 text-red-700 bg-red-100 rounded-md",children:k}):0===f.length?(0,r.jsxs)("div",{className:"p-8 text-center text-gray-500 bg-gray-100 rounded-md",children:[(0,r.jsx)(c.jRj,{className:"mx-auto mb-2 text-gray-300",size:48}),(0,r.jsx)("p",{children:"Nenhum servi\xe7o encontrado com os crit\xe9rios de busca."}),(0,r.jsx)("p",{className:"mt-2",children:"Tente ajustar seus filtros ou buscar por termos diferentes."})]}):(0,r.jsx)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:f.map(e=>(0,r.jsx)(d,{service:e,onViewDetails:z,onMakeProposal:B},e.id))})]})}function h(){return(0,r.jsx)(a.Suspense,{fallback:(0,r.jsx)(m,{}),children:(0,r.jsx)(x,{})})}},8222:function(e,t,s){"use strict";s.d(t,{U2:function(){return n},v_:function(){return c}});var r=s(7832);async function a(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{let s;let{authenticated:a=!1,handleError:n=!0,headers:c={},...o}=t,l={"Content-Type":"application/json",...c};if(a){let e=(0,r.bW)();e&&(l.Authorization="Bearer ".concat(e))}let i=e.startsWith("http")?e:"".concat("http://localhost:3000/api").concat(e),d=await fetch(i,{...o,headers:l}),u=d.headers.get("content-type");if(s=u&&u.includes("application/json")?await d.json():await d.text(),!d.ok)throw 401===d.status&&a&&((0,r.H6)(),window.location.href="/login?redirect=".concat(encodeURIComponent(window.location.pathname))),{status:d.status,message:s.error||d.statusText,data:s};return{data:s,status:d.status}}catch(e){return t.handleError&&console.error("API request error:",e),{error:e.message||"Erro desconhecido",status:e.status||500}}}function n(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return a(e,{method:"GET",...t})}function c(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return a(e,{method:"POST",body:JSON.stringify(t),...s})}},7832:function(e,t,s){"use strict";s.d(t,{H6:function(){return o},bW:function(){return c},uB:function(){return n}});var r=s(1490);let a={expires:7,path:"/",sameSite:"strict",secure:!0};function n(e){!function(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};r.Z.set(e,t,{...a,...s})}("token",e)}function c(){return r.Z.get("token")}function o(){!function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};r.Z.remove(e,{...t,path:"/"})}("token")}}},function(e){e.O(0,[491,971,938,744],function(){return e(e.s=6708)}),_N_E=e.O()}]);