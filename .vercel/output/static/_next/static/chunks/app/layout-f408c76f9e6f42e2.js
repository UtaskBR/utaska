(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[185],{2862:function(e,t,r){Promise.resolve().then(r.bind(r,7657))},7657:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return v}});var s=r(7437),a=r(9646),l=r.n(a),n=r(2265),c=r(4033),i=r(7832),o=r(8222);let u=(0,n.createContext)({user:null,loading:!0,error:null,login:async()=>!1,register:async()=>!1,logout:()=>{},updateUser:async()=>!1});function d(e){let{children:t}=e,[r,a]=(0,n.useState)(null),[l,d]=(0,n.useState)(!0),[x,h]=(0,n.useState)(null),m=(0,c.useRouter)();(0,n.useEffect)(()=>{(async()=>{try{if(d(!0),h(null),!(0,i.bW)()){d(!1);return}let e=await (0,o.U2)("/api/auth/me",{authenticated:!0});if(e.error)throw Error(e.error);a(e.data.user)}catch(e){console.error("Erro ao verificar autentica\xe7\xe3o:",e),(0,i.H6)(),h(e.message||"Erro ao verificar autentica\xe7\xe3o")}finally{d(!1)}})()},[]);let f=async(e,t)=>{try{d(!0),h(null);let r=await (0,o.v_)("/api/auth/login",{email:e,password:t});if(r.error)throw Error(r.error);return(0,i.uB)(r.data.token),a(r.data.user),!0}catch(e){return console.error("Erro ao fazer login:",e),h(e.message||"Credenciais inv\xe1lidas"),!1}finally{d(!1)}},p=async e=>{try{d(!0),h(null);let t=await (0,o.v_)("/api/auth/register",e);if(t.error)throw Error(t.error);return(0,i.uB)(t.data.token),a(t.data.user),!0}catch(e){return console.error("Erro ao registrar:",e),h(e.message||"Erro ao criar conta"),!1}finally{d(!1)}},b=async e=>{try{d(!0),h(null);let t=await (0,o.v_)("/api/users/profile",e,{authenticated:!0});if(t.error)throw Error(t.error);return a(e=>e?{...e,...t.data.user}:t.data.user),!0}catch(e){return console.error("Erro ao atualizar perfil:",e),h(e.message||"Erro ao atualizar perfil"),!1}finally{d(!1)}};return(0,s.jsx)(u.Provider,{value:{user:r,loading:l,error:x,login:f,register:p,logout:()=>{(0,i.H6)(),a(null),m.push("/login")},updateUser:b},children:t})}var x=r(1396),h=r.n(x),m=r(6691),f=r.n(m),p=r(8980);function b(){let e=(0,n.useContext)(u);if(!e)throw Error("useAuth deve ser usado dentro de um AuthProvider");return e}function j(){let[e,t]=(0,n.useState)(!1),[r,a]=(0,n.useState)(!1),l=(0,c.usePathname)(),{user:i,logout:o}=b();return(0,s.jsxs)("nav",{className:"bg-white shadow-md",children:[(0,s.jsx)("div",{className:"container px-4 mx-auto",children:(0,s.jsxs)("div",{className:"flex items-center justify-between h-16",children:[(0,s.jsx)("div",{className:"flex items-center",children:(0,s.jsx)(h(),{href:"/",className:"flex items-center",children:(0,s.jsx)("span",{className:"text-2xl font-bold text-utask-blue",children:"UTASK"})})}),(0,s.jsx)("div",{className:"hidden md:block",children:(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,s.jsx)(h(),{href:"/",className:"px-3 py-2 rounded-md text-sm font-medium ".concat("/"===l?"text-utask-blue":"text-gray-600 hover:text-utask-blue"),children:"In\xedcio"}),(0,s.jsx)(h(),{href:"/search",className:"px-3 py-2 rounded-md text-sm font-medium ".concat("/search"===l?"text-utask-blue":"text-gray-600 hover:text-utask-blue"),children:"Buscar"}),(0,s.jsx)(h(),{href:"/map",className:"px-3 py-2 rounded-md text-sm font-medium ".concat("/map"===l?"text-utask-blue":"text-gray-600 hover:text-utask-blue"),children:"Mapa"}),i&&(0,s.jsx)(h(),{href:"/create",className:"px-3 py-2 rounded-md text-sm font-medium ".concat("/create"===l?"text-utask-blue":"text-gray-600 hover:text-utask-blue"),children:"Criar Servi\xe7o"})]})}),(0,s.jsx)("div",{className:"hidden md:flex items-center space-x-4",children:i?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(h(),{href:"/notifications",className:"p-2 text-gray-600 rounded-full hover:bg-gray-100 relative",children:[(0,s.jsx)(p.vWP,{size:20}),(0,s.jsx)("span",{className:"absolute top-0 right-0 w-2 h-2 bg-red-500 rounded-full"})]}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("button",{onClick:()=>{a(!r),e&&t(!1)},className:"flex items-center text-gray-600 focus:outline-none",children:(0,s.jsx)("div",{className:"relative w-8 h-8 overflow-hidden bg-utask-blue rounded-full",children:i.avatar_url?(0,s.jsx)(f(),{src:i.avatar_url,alt:i.name,fill:!0,className:"object-cover"}):(0,s.jsx)("div",{className:"flex items-center justify-center w-full h-full text-white",children:i.name.charAt(0).toUpperCase()})})}),r&&(0,s.jsx)("div",{className:"absolute right-0 z-10 w-48 mt-2 bg-white rounded-md shadow-lg",children:(0,s.jsxs)("div",{className:"py-1",children:[(0,s.jsxs)(h(),{href:"/profile",className:"flex items-center px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:[(0,s.jsx)(p.fzv,{className:"mr-2"}),"Meu Perfil"]}),(0,s.jsxs)(h(),{href:"/wallet",className:"flex items-center px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:[(0,s.jsx)("span",{className:"mr-2",children:"\uD83D\uDCB0"}),"Carteira"]}),(0,s.jsxs)(h(),{href:"/agenda",className:"flex items-center px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:[(0,s.jsx)("span",{className:"mr-2",children:"\uD83D\uDCC5"}),"Agenda"]}),(0,s.jsxs)("button",{onClick:o,className:"flex items-center w-full px-4 py-2 text-sm text-red-600 hover:bg-gray-100",children:[(0,s.jsx)(p.xqh,{className:"mr-2"}),"Sair"]})]})})]})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(h(),{href:"/login",className:"px-4 py-2 text-sm font-medium text-utask-blue hover:text-utask-blue-dark",children:"Entrar"}),(0,s.jsx)(h(),{href:"/register",className:"px-4 py-2 text-sm font-medium text-white bg-utask-blue rounded-md hover:bg-utask-blue-dark",children:"Cadastrar"})]})}),(0,s.jsx)("div",{className:"flex md:hidden",children:(0,s.jsx)("button",{onClick:()=>{t(!e),r&&a(!1)},className:"p-2 text-gray-600 rounded-md hover:bg-gray-100 focus:outline-none",children:e?(0,s.jsx)(p.q5L,{size:24}):(0,s.jsx)(p.cur,{size:24})})})]})}),e&&(0,s.jsx)("div",{className:"md:hidden",children:(0,s.jsxs)("div",{className:"px-2 pt-2 pb-3 space-y-1 sm:px-3",children:[(0,s.jsx)(h(),{href:"/",className:"block px-3 py-2 rounded-md text-base font-medium ".concat("/"===l?"text-utask-blue":"text-gray-600 hover:text-utask-blue"),children:"In\xedcio"}),(0,s.jsx)(h(),{href:"/search",className:"block px-3 py-2 rounded-md text-base font-medium ".concat("/search"===l?"text-utask-blue":"text-gray-600 hover:text-utask-blue"),children:"Buscar"}),(0,s.jsx)(h(),{href:"/map",className:"block px-3 py-2 rounded-md text-base font-medium ".concat("/map"===l?"text-utask-blue":"text-gray-600 hover:text-utask-blue"),children:"Mapa"}),i&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(h(),{href:"/create",className:"block px-3 py-2 rounded-md text-base font-medium ".concat("/create"===l?"text-utask-blue":"text-gray-600 hover:text-utask-blue"),children:"Criar Servi\xe7o"}),(0,s.jsx)(h(),{href:"/notifications",className:"block px-3 py-2 rounded-md text-base font-medium ".concat("/notifications"===l?"text-utask-blue":"text-gray-600 hover:text-utask-blue"),children:"Notifica\xe7\xf5es"}),(0,s.jsx)(h(),{href:"/profile",className:"block px-3 py-2 rounded-md text-base font-medium ".concat("/profile"===l?"text-utask-blue":"text-gray-600 hover:text-utask-blue"),children:"Meu Perfil"}),(0,s.jsx)(h(),{href:"/wallet",className:"block px-3 py-2 rounded-md text-base font-medium ".concat("/wallet"===l?"text-utask-blue":"text-gray-600 hover:text-utask-blue"),children:"Carteira"}),(0,s.jsx)(h(),{href:"/agenda",className:"block px-3 py-2 rounded-md text-base font-medium ".concat("/agenda"===l?"text-utask-blue":"text-gray-600 hover:text-utask-blue"),children:"Agenda"}),(0,s.jsx)("button",{onClick:o,className:"block w-full text-left px-3 py-2 rounded-md text-base font-medium text-red-600 hover:bg-gray-100",children:"Sair"})]}),!i&&(0,s.jsxs)("div",{className:"pt-4 pb-3 border-t border-gray-200",children:[(0,s.jsx)("div",{className:"flex items-center px-5",children:(0,s.jsx)(h(),{href:"/login",className:"block w-full px-4 py-2 text-center text-sm font-medium text-utask-blue border border-utask-blue rounded-md hover:bg-utask-blue-light",children:"Entrar"})}),(0,s.jsx)("div",{className:"mt-3 px-5",children:(0,s.jsx)(h(),{href:"/register",className:"block w-full px-4 py-2 text-center text-sm font-medium text-white bg-utask-blue rounded-md hover:bg-utask-blue-dark",children:"Cadastrar"})})]})]})})]})}function g(){let e=(0,c.usePathname)(),{user:t}=b();return t||["/login","/register","/","/search","/map"].includes(e)?(0,s.jsx)("div",{className:"fixed bottom-0 left-0 right-0 z-50 bg-white border-t border-gray-200 md:hidden",children:(0,s.jsxs)("div",{className:"flex items-center justify-around h-16",children:[(0,s.jsxs)(h(),{href:"/",className:"flex flex-col items-center justify-center w-full h-full ".concat("/"===e?"text-utask-blue":"text-gray-500"),children:[(0,s.jsx)(p.m6D,{size:20}),(0,s.jsx)("span",{className:"mt-1 text-xs",children:"In\xedcio"})]}),(0,s.jsxs)(h(),{href:"/search",className:"flex flex-col items-center justify-center w-full h-full ".concat("/search"===e?"text-utask-blue":"text-gray-500"),children:[(0,s.jsx)(p.jRj,{size:20}),(0,s.jsx)("span",{className:"mt-1 text-xs",children:"Buscar"})]}),t&&(0,s.jsx)(h(),{href:"/create",className:"flex flex-col items-center justify-center w-full h-full ".concat("/create"===e?"text-utask-blue":"text-gray-500"),children:(0,s.jsx)("div",{className:"flex items-center justify-center w-12 h-12 mb-1 text-white bg-utask-blue rounded-full",children:(0,s.jsx)(p.OvN,{size:24})})}),(0,s.jsxs)(h(),{href:"/map",className:"flex flex-col items-center justify-center w-full h-full ".concat("/map"===e?"text-utask-blue":"text-gray-500"),children:[(0,s.jsx)(p.MIl,{size:20}),(0,s.jsx)("span",{className:"mt-1 text-xs",children:"Mapa"})]}),t?(0,s.jsxs)(h(),{href:"/profile",className:"flex flex-col items-center justify-center w-full h-full ".concat("/profile"===e?"text-utask-blue":"text-gray-500"),children:[(0,s.jsx)(p.fzv,{size:20}),(0,s.jsx)("span",{className:"mt-1 text-xs",children:"Perfil"})]}):(0,s.jsxs)(h(),{href:"/login",className:"flex flex-col items-center justify-center w-full h-full ".concat("/login"===e?"text-utask-blue":"text-gray-500"),children:[(0,s.jsx)(p.fzv,{size:20}),(0,s.jsx)("span",{className:"mt-1 text-xs",children:"Entrar"})]})]})}):null}var y=r(5925);function v(e){let{children:t}=e;return(0,s.jsxs)("html",{lang:"pt-BR",children:[(0,s.jsxs)("head",{children:[(0,s.jsx)("title",{children:"UTASK - Plataforma de Servi\xe7os"}),(0,s.jsx)("meta",{name:"description",content:"Conectando pessoas a servi\xe7os de qualidade"}),(0,s.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1"}),(0,s.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,s.jsx)("body",{className:l().className,children:(0,s.jsxs)(d,{children:[(0,s.jsxs)("div",{className:"flex flex-col min-h-screen",children:[(0,s.jsx)(j,{}),(0,s.jsx)("main",{className:"flex-grow",children:t}),(0,s.jsx)(g,{})]}),(0,s.jsx)(y.x7,{position:"top-center"})]})})]})}r(1359)},8222:function(e,t,r){"use strict";r.d(t,{U2:function(){return l},v_:function(){return n}});var s=r(7832);async function a(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{let r;let{authenticated:a=!1,handleError:l=!0,headers:n={},...c}=t,i={"Content-Type":"application/json",...n};if(a){let e=(0,s.bW)();e&&(i.Authorization="Bearer ".concat(e))}let o=e.startsWith("http")?e:"".concat("http://localhost:3000/api").concat(e),u=await fetch(o,{...c,headers:i}),d=u.headers.get("content-type");if(r=d&&d.includes("application/json")?await u.json():await u.text(),!u.ok)throw 401===u.status&&a&&((0,s.H6)(),window.location.href="/login?redirect=".concat(encodeURIComponent(window.location.pathname))),{status:u.status,message:r.error||u.statusText,data:r};return{data:r,status:u.status}}catch(e){return t.handleError&&console.error("API request error:",e),{error:e.message||"Erro desconhecido",status:e.status||500}}}function l(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return a(e,{method:"GET",...t})}function n(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return a(e,{method:"POST",body:JSON.stringify(t),...r})}},7832:function(e,t,r){"use strict";r.d(t,{H6:function(){return c},bW:function(){return n},uB:function(){return l}});var s=r(1490);let a={expires:7,path:"/",sameSite:"strict",secure:!0};function l(e){!function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};s.Z.set(e,t,{...a,...r})}("token",e)}function n(){return s.Z.get("token")}function c(){!function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};s.Z.remove(e,{...t,path:"/"})}("token")}},1359:function(){}},function(e){e.O(0,[491,441,971,938,744],function(){return e(e.s=2862)}),_N_E=e.O()}]);